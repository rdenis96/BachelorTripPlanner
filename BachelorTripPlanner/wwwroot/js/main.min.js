var globalModule=angular.module("globalModule",["ngRoute","ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ngStorage","ui.bootstrap","ui.select","toastr"]),landingPageTabsEnum;globalModule.config(["$routeProvider","$locationProvider","toastrConfig",function(n,t,i){n.when("/",{templateUrl:"AppViews/Home/home.html",controller:"HomeController"}).when("/home",{templateUrl:"AppViews/Home/home.html",controller:"HomeController"}).when("/welcome",{templateUrl:"AppViews/LandingPage/landingPage.html",controller:"LandingPageController"}).when("/account/interests",{templateUrl:"AppViews/Account/interests.html",controller:"AccountController"}).when("/account/editAccount",{templateUrl:"AppViews/Account/edit-account.html",controller:"AccountController"}).otherwise({redirectTo:"/"});angular.extend(i,{autoDismiss:!1,maxOpened:1,newestOnTop:!0,positionClass:"toast-top-center",preventDuplicates:!1,preventOpenDuplicates:!1,target:"body",closeButton:!0,extendedTimeOut:5e3,timeOut:5e3});t.html5Mode(!0)}]);landingPageTabsEnum={Welcome:"Welcome",Register:"Register",Login:"Login"};globalModule.factory("homeRepository",["$resource",function(n){return n("api/home",{},{getAll:{method:"GET",url:"api/home/getAll",isArray:!0}})}]);globalModule.controller("HomeController",["$scope","$window","$localStorage","homeRepository",function(n){n.init=function(){}}]);globalModule.controller("HeaderController",["$scope","$window","$localStorage","$uibModal","homeRepository",function(n,t,i,r){n.isLogged=i.TPUserId!==null&&i.TPUserId!==undefined;n.init=function(){n.isLogged===!0?n.userId=i.TPUserId:t.location.href.indexOf("/welcome")==-1&&(t.location.href="/welcome")};n.login=function(){var n=r.open({templateUrl:"AppViews/LandingPage/login-modal.html",controller:"LoginModalController",backdrop:"static",keyboard:!1,size:"lg"});n.result.then(function(){},function(){})};n.logout=function(){i.TPUserId=null;t.location.href="/welcome"}}]);globalModule.controller("LandingPageController",["$scope","$window","$http","$localStorage","landingPageRepository","toastr",function(n,t,i,r,u,f){n.landingPage=!0;n.landingPageTabsEnum=landingPageTabsEnum;n.selectedTab=landingPageTabsEnum.Welcome;n.changeTab=function(t){switch(t){case landingPageTabsEnum.Welcome:n.selectedTab=landingPageTabsEnum.Welcome;break;case landingPageTabsEnum.Login:n.selectedTab=landingPageTabsEnum.Login;break;case landingPageTabsEnum.Register:n.selectedTab=landingPageTabsEnum.Register}};n.register=function(){i.get("https://ipapi.co/json/").success(function(t){n.registerIp=t.ip;var i={email:n.registerEmail,password:n.registerPassword,registerDate:new Date,lastOnline:null,ip:n.registerIp,phone:n.registerPhoneNumber!=undefined&&n.registerPhoneNumber.length>0?n.registerPhoneNumber:null},r=u.register(i).$promise;r.then(function(t){f.success(t.message);n.changeTab(landingPageTabsEnum.Login)}).catch(function(n){f.warning(n.data)})})};n.login=function(){var i={email:n.loginEmail,password:n.loginPassword},e=u.login(i).$promise;e.then(function(n){r.TPUserId=n.userId;t.location.href="/home";f.success(n.message)}).catch(function(n){console.log(n);f.warning(n.data)})}}]);globalModule.factory("landingPageRepository",["$resource",function(n){return n("api/landingpage",{},{register:{method:"POST",url:"api/landingpage/register"},login:{method:"GET",url:"api/landingpage/login"}})}]);globalModule.controller("AccountController",["$scope","$localStorage","$uibModal","accountRepository","toastr",function(n,t,i,r,u){n.user={};n.initEditAccount=function(){n.userId=t.TPUserId;var i=r.getUser({userId:n.userId}).$promise;i.then(function(t){n.user=t}).catch(function(n){u.warning(n.data)})};n.initInterests=function(){n.userId=t.TPUserId};n.openCountryAndCityModal=function(){var n=i.open({templateUrl:"AppViews/Account/interest-country-city-modal.html",controller:"AccountInterestsController",backdrop:"static",keyboard:!1,size:"lg"});n.result.then(function(){},function(){})};n.update=function(){if(n.newPassword!=n.confPassword){u.warning("The password does not match, please type the same password in Confirm Password field!");return}var t={email:n.user.email,password:n.newPassword},i=r.update({userId:n.userId},t).$promise;i.then(function(){u.success("The account was updated successfuly!")}).catch(function(n){u.warning(n.data)})}}]);globalModule.factory("accountRepository",["$resource",function(n){return n("api/account",{},{getUser:{method:"GET",url:"api/account/getUser"},getCountries:{method:"GET",url:"api/account/getCountries",isArray:!0},update:{method:"PUT",url:"api/account/update"},updateCountriesAndCities:{method:"PUT",url:"api/account/updateCountriesAndCities"}})}]);globalModule.controller("AccountInterestsController",["$scope","$localStorage","accountRepository","toastr",function(n,t,i,r){n.user={};n.countriesList=[];n.initCountryCity=function(){n.userId=t.TPUserId;var u=i.getCountries().$promise;u.then(function(t){n.countriesList=t}).catch(function(n){r.warning(n.data)})};n.updateCountryCity=function(){if(n.newPassword!=n.confPassword){r.warning("The password does not match, please type the same password in Confirm Password field!");return}var t={email:n.user.email,password:n.newPassword},u=i.updateCountriesAndCities({userId:n.userId},t).$promise;u.then(function(){r.success("The account was updated successfuly!")}).catch(function(n){r.warning(n.data)})}}]);globalModule.controller("LoginModalController",["$scope","$window","$localStorage","$uibModalInstance","landingPageRepository","toastr",function(n,t,i,r,u,f){n.login=function(){var e={email:n.loginEmail,password:n.loginPassword},o=u.login(e).$promise;o.then(function(n){r.close();i.TPUserId=n.userId;t.location.href="/home";f.success(n.message)}).catch(function(n){console.log(n);f.warning(n.data)})};n.close=function(){r.close()}}]);